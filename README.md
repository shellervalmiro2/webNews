# kpo2025

## Конструирование ПО 2025 - Выработка требований

**Тема:** Веб приложение для компании (Для Новостей)

**Авторы:**
- Мунгой Шеллер

**Группа:** 5130904/30103

---

### 1. Основные функции проекта:

- Новостная лента (актуальные новости)
- Музыкальная платформа (стриминг музыки)
- Видео-стриминг (платный контент)
- Продажа билетов на мероприятия
- Платёжные системы: Visa
- **Услуги:** цифровой маркетинг, графический дизайн, продвижение, видеосъёмка, фотосъёмка

### 2. Оценка аудитории

- Суточная активная аудитория: ~15 000 пользователей
- Период хранения данных: от 5 до 7 лет

### 3. Пользовательские сценарии

#### 3.1. Как пользователь, я хочу читать актуальные новости и получать уведомления о важных событиях, чтобы не пропустить важную информацию.

**Сценарий:**

- Пользователь заходит на главную страницу - видит ленту новостей, музыку, услуги и тд
- заходить в страницу новостей и Может выбрать категории (политика, культура, технологии и т.д.)
- Может подписаться на push/email - уведомления по выбранным темам
- При публикации срочной новости (например, ЧС или крупное событие) - получает уведомление

**Технические аспекты:**

- RSS / push-уведомления
- Персонализация ленты

#### 3.2. Как пользователь, я хочу купить билет на концерт через сайт и оплатить его удобным способом, чтобы быстро получить подтверждение и QR-код.

**Сценарий:**

- Пользователь выбирает мероприятие в разделе «мероприятия»
- Выбирает дату, место, количество билетов
- Переходит к оплате - выбирает способ: Visa, Apple Pay, PayPal, MonCash и др.
- После успешной оплаты получает инфориацию с билетом (PDF + QR-код)
- Билет отображается в личном кабинете

**Технические аспекты:**

- Интеграция с платёжными шлюзами
- Хранение истории покупок

#### 3.3. Как клиент, я хочу заказать услугу (например, видеосъёмку мероприятия) и связаться с менеджером, чтобы обсудить детали и получить коммерческое предложение.

**Сценарий:**

- Пользователь заходит в раздел «Услуги» - выбирает «Видеосъёмка»
- Заполняет форму: дата, тип события, бюджет, контакты
- Получает подтверждение и ожидает звонка/письма от менеджера
- В личном кабинете видит статус заявки

**Технические аспекты:**

- Уведомления о статусе
- Хранение переписки и договоров

#### 3.4. Как подписчик, я хочу смотреть эксклюзивные видео и слушать премиальную музыку.

---

## Конструирование ПО 2025

## Архитектура и проектирование

**Тема:** Веб приложение для компании (Для Новостей)

**Авторы:**
- Масеко Звелаке
- Ха Жа Кинь
- Гюнеш Мустафа

**Группа:** 5130904/30103

### 1. Характер нагрузки на сервис:

#### 1.1. Соотношение R/W нагрузки

| Раздел | Чтение | Запись |
|--------|--------|--------|
| Новостной контент | 90% | 10% (редакторы, модераторы) |
| Музыка/видео стриминг | 95% | 5% (загрузка контента админами) |
| Продажа билетов | 70% (просмотр мероприятий) | 30% (бронирование, оплата) |
| Услуги (маркетинг, дизайн и т.д.) | 60% | 40% (заявки, коммуникация) |

**Общее соотношение:** 79% R / 21% W

#### 1.2. Объемы трафика

**Входящий трафик (к пользователям):**

- **DAU:** 15 000 пользователей
- **Новости/Текст:** ~60 ГБ/день (15к пользователей * ~4 МБ данных статей, CSS, JS)
- **Музыка:** ~150 ГБ/день (допустим, 20% пользователей слушают ~30 мин = ~50 МБ/пользователь → 3000 * 50 МБ)
- **Видео (стриминг):** ~1 ТБ/день (для 2000 подписчиков, смотрящих в SD ~1 ГБ/день → 2000 * 500 МБ)

**Исходящий трафик (от пользователей):**

- Незначительный, в основном загрузка аватарок и форма заявок с файлами

#### 1.3. Объемы дисковой системы

- Новости + метаданные: ~5 ГБ/год
- Медиаконтент (видео + аудио): ~20 ТБ/год
- База данных (транзакции, профили, билеты): ~1 ГБ/год

### 2. Первые две диаграммы из подхода [C4 Model](https://c4model.com/)

#### 2.1. System Context Diagram (C4 Level 1)

<img width="636" height="392" alt="image" src="https://github.com/user-attachments/assets/23b8fd96-5c97-452a-b447-a6bc0b351911" />



#### 2.2. Container Diagram (C4 Level 2)

<img width="551" height="799" alt="image" src="https://github.com/user-attachments/assets/fdcabeaa-4837-4943-b324-70d330b0fa88" />


### 3. Контракты API + Ожидаемые нефункциональные требования на время отклика

#### 3.1. Получение списка новостей:

- **Метод:** GET /api/v1/news
- **Параметры:**
  - `page` (number, optional)
  - `category` (string, optional)
  - `pageSize` (number, optional, default: 20)
- **Ответ (200 OK):**
- **Нефункциональные требования:**
  - **Время отклика (p95):** < 200 мс
  - **Доступность (Availability):** > 99.9%
  - **Пропускная способность:** > 1000 RPS

#### 3.2. Покупка билета

- **Метод:** POST /api/v1/events/{eventId}/tickets
- **Заголовки:** Authorization: Bearer <JWT>
- **Тело запроса:**
- **Ответ (201 Created):**
- **Нефункциональные требования:**
  - **Время отклика (p95):** <2 секунды (из-за взаимодействия с платежным шлюзом)
  - **Безопасность:** PCI DSS compliance для любых операций с картами

### 4. Схема базы данных + почему она выдержит нефункциональные требования

<img width="799" height="322" alt="image" src="https://github.com/user-attachments/assets/eb8e1d1c-8c98-4ff9-a6fb-694d10baa18f" />


#### 4.1. Почему схема выдержит нагрузку:

- **Индексы:** Все PK, FK, email, published_at, event_id, user_id индексируются
- **Read Replica:** Все тяжелые SELECT (новости, поиск) идут на реплику
- **Нормализация:** Снижает избыточность данных и аномалии при обновлении
- **Шардирование:** При росте можно шардировать Events или Articles по category или дате

### 5. Схема масштабирования сервиса при росте нагрузка 10 раз

При росте до ~150 000 пользователей/день:

#### 5.1. Фронтенд:

- SSR → ISR (Incremental Static Regeneration) для новостей

#### 5.2. Бэкенд:

- API Gateway с rate limiting и circuit breaker

#### 5.3. База данных:

- mySQL → read replicas (3–5 шт.)

#### 5.4. Медиа:

- HLS-стриминг через Cloudflare Stream или AWS MediaConvert + CloudFront или antmedia
- Автоматическое сжатие и транскодирование

#### 5.5. Платежи:

- Асинхронная обработка через очередь (RabbitMQ/Kafka)
- Идемпотентность запросов
